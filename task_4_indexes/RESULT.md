Для решения задачи будем считать, что мы имеем дело с системой, UML диаграмма которой разработана мной в другой задаче - [domain.png](domain.png)

Для решения задачи создаем два индекса по id пола и по id города, и один индекс - составной по id пола + id города в таблице profile. Отдельно отмечу, что для двух первых индексов я использовал тип индекса hash, потому что он работает быстрее, чем дефолтовый b-tree, а поиск у нас предполагается только по точному совпадению. Но только для двух первых индексов - для составного индекса using hash не поддерживает, пришлось создать индекс для него по умолчанию, b-tree. Можно было бы также оставить во всех трех индексах тип индекса по умолчанию, так как и полов, и городов не так много, и выигрыш будет незначительный, как мне кажется, так что этот момент не принципиальный.

Используя схему нашей БД можно также составить еще много разных индексов или сочетаний (индекс + правильно составленный обходной запрос), которые оптимизируют работу нашей БД. Но это зависит на самом деле от приложения, которое будет использовать эту БД - нет смысла загромождать БД индексами, которые не будут использоваться, но будут замедлять работу БД при обновлениях и создании новых записей в таблицах. Поэтому ответ на вопрос - какие еще можно составить индексы, зависит больше не от схемы таблиц в БД, а от бизнес-логи приложения, и заранее ответить на этот вопрос нельзя.

